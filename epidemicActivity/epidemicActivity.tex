%!TEX root = ../main.tex
\documentclass{ximera}

\input{../preamble.tex}

\title{An Epidemics Model}
\author{Anna Davis, Justin Greenly, L. Felipe Martins, Paul Zachlin}

\begin{document}

\begin{abstract}
Activity with a model for an epidemic. Based on: (*** add source ***)
\end{abstract}

\maketitle

The table below contains information on the number of bedridden students:

\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|}\hline
Time (in days)           & 0 & 1 &  2 &  3 &  4 &    5 &   6  \\\hlineNumber of Bedridden Boys & 1 & 3 & 25 & 72 & 222 & 282 & 256 \\\hline\hline
Time (in days) &             7 &   8 &   9 & 10 & 11 & 12 & 13\\\hline
Number of Bedridden Boys & 233 & 189 & 123 & 70 & 25 & 11 &  4\\\hline
\end{tabular}

We first enter the data using Sage lists, and plot the data:

\begin{sageCell}
days = srange(0, 14)
infected = [  1,   3,  25, 72, 222, 282, 256, 
            233, 189, 123, 70,  25,  11,   4]
points(zip(days, infected))
\end{sageCell}

We now want to solve the system of differential equations:
\[
\frac{dI}{dt}=pk(763-I-R)-rI,\quad\frac{dR}{dt}=rI
\]
with the initial condition:
\[
I(0)=1,\quad R(0)=0.
\]

Solution method 1: Sage function $\mathtt{desolve_system_rk4}$:

\begin{sageCell}
I, R, t = var('I R t')
r = 0.5206
k = 0.0473
p = 0.07
NPop = 763
deI = p*k*I*(NPop-I-R) - r*I
deR = r*I
t0, I0, R0 = 0.0, 1.0, 0.0
soln = desolve_system_rk4([deI, deR], (I, R), 
                          ics=[t0, I0, R0], ivar=t,
                          end_points=13, step=0.1)
tIvalues = [[p[0],p[1]] for p in soln]
g = points(zip(days, infected), size=48, color='red')
g += line(tIvalues)
g.show()
\end{sageCell}

This is the same thing in an interact, so the student can use the sliders instead of entering the values:
\begin{sageCell}
from ipywidgets import FloatSlider
days = srange(0, 14)
infected = [  1,   3,  25, 72, 222, 282, 256, 
            233, 189, 123, 70,  25,  11,   4]
I, R, t = var('I R t')
NPop = 763
@interact
def _(r=FloatSlider(min=0,max=1,step=0.01,value=0.5,continuous_update=False),
      k=FloatSlider(min=0,max=0.1,step=0.01,value=0.04,continuous_update=False),
      p=FloatSlider(min=0,max=1,step=0.01,value=0.07,continuous_update=False)):
    deI = p*k*I*(NPop-I-R) - r*I
    deR = r*I
    t0, I0, R0 = 0.0, 1.0, 0.0
    soln = desolve_system_rk4([deI, deR], (I, R), 
                               ics=[t0, I0, R0], ivar=t,
                               end_points=13, step=0.1)
    tIvalues = [[p[0],p[1]] for p in soln]
    g = points(zip(days, infected), size=48, color='red')
    g += line(tIvalues)
    g.show(xmin=0, xmax=13, ymin=0, ymax=350)
\end{sageCell}

The next demo is the same interact, but the code is hidden:

\begin{sageOutput}
from ipywidgets import FloatSlider
days = srange(0, 14)
infected = [  1,   3,  25, 72, 222, 282, 256, 
            233, 189, 123, 70,  25,  11,   4]
I, R, t = var('I R t')
NPop = 763
@interact
def _(r=FloatSlider(min=0,max=1,step=0.01,value=0.5,continuous_update=False),
      k=FloatSlider(min=0,max=0.1,step=0.01,value=0.04,continuous_update=False),
      p=FloatSlider(min=0,max=1,step=0.01,value=0.07,continuous_update=False)):
    deI = p*k*I*(NPop-I-R) - r*I
    deR = r*I
    t0, I0, R0 = 0.0, 1.0, 0.0
    soln = desolve_system_rk4([deI, deR], (I, R), 
                               ics=[t0, I0, R0], ivar=t,
                               end_points=13, step=0.1)
    tIvalues = [[p[0],p[1]] for p in soln]
    g = points(zip(days, infected), size=48, color='red')
    g += line(tIvalues)
    g.show(xmin=0, xmax=13, ymin=0, ymax=350)
\end{sageOutput}

\end{document}
