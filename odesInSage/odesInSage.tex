\documentclass{ximera}

\input{../preamble.tex}



\title{Solving ODEs with Sage}
\author{Anna Davis, Just Greenly, , L. Felipe Martins, Paul Zachlin}

\begin{document}

\begin{abstract}
This activity shows how to use Sage to solve differential equations.

\end{abstract}

\maketitle

Let's first consider the problem of finding the general solution of an ODE symbolically. As an example, let's consider the differential equation:
\[
\frac{dx}{dt} = t - x
\]

The Sage function \texttt{desolve} is used to find symbolic solutions of ODEs. The following Sage cell shows how to solve the ODE above:

\begin{sageCell}
t = var('t')
x = function('x')(t)
de = diff(x, t) ==  t - x
soln = desolve(de, [x, t])
soln
\end{sageCell}

Clicking the \texttt{Evaluate} button will execute the cell and compute the general solution of the differential equation. 

\begin{problem} In the answer box below, enter the general solution of the differential equation 

Use the variable $C$ for the constant of integration.

The general solution of the DE is: $\answer{((t - 1)e^{t} + C)e^{-t}}$.
\end{problem}

\emph{Hint}: If you are getting an error, you are probably trying to enter $\_C$ as your constant of integration. Use the variable $C$ instead.

We can also use the \texttt{desolve} function to find the solution of initial value problems. Let's, for example, consider the problem:
\[
\frac{dx}{dt} = t - x,\quad x(1) = 3
\]

The following Sage cell demonstrates how to solve this problem:

\begin{sageCell}
t = var('t')
x = function('x')(t)
de = diff(x, t) ==  t - x
soln = desolve(de, [x, t], ics=[1,3])
soln
\end{sageCell}

\begin{problem} 
The  solution of the initial value problem is: $\answer{((t - 1)e^{t} + 3e)e^{-t}}$.
\end{problem}

If we need a single numerical value of the solution, we can compute it as shown in the cell below:
\begin{sageCell}
soln(3.2).n()
\end{sageCell}

\begin{problem} Use the Sage cell above to compute the following values for the solution of the IVP:

\[x(3.2)=\answer{2.53240947508700}\]

\[x(1.4)=\answer{2.41096013810692}\]

\[x(0.75)=\answer{3.60207625006322}\]

\begin{sageCell}
[soln(tval).n() for tval in srange(1, 5, 0.1)]
\end{sageCell}

The output of the previous cell is a \emph{list}, with the values of the solution in a specified range. The range is defined by the Sage expression:
\[
\mathtt{srange(1, 5, 0.1)}
\]
This defines a range 





\end{document}